<!DOCTYPE html>



<html class="not-ie" lang="en"> 
<head>

	
	<meta charset="utf-8">
	<title>goa :: Design-first API Generation</title>
	<meta name="description" content="Goa is a code generation framework built in Go that provides the developer with a clear and concise path to generate idiomatic API and Microservice architectures by using a design-first methodology.">

	<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">

	
	<link href="/css/style.css" rel="stylesheet" type="text/css" />
	<link href="/css/font-awesome/font-awesome.min.css" rel="stylesheet" />
	
	
	
	<link href='http://fonts.googleapis.com/css?family=Open+Sans:300,400,600,700,800' rel='stylesheet' type='text/css' />

	
	
	<script src="https://ajax.googleapis.com/ajax/libs/jquery/1.10.2/jquery.min.js"></script>
	<script>window.jQuery || document.write('<script src="/js/jquery-1.10.2.min.js"><\/script>')</script>
	
	
	

</head>

<body>

		
	<header id="header">
		
		<nav class="navbar">
			<div class="navbar-inner">
				<div class="container">
					
					<a class="brand" href="/">
						goa
					</a>
					<ul class="nav">
						<li><a href="/" title="Home">Home</a></li>
						<li><a href="/guide/" title="Getting Started">Getting Started</a></li>

						<li class="dropdown">
							<a href="/components/" title="components">Components</a>
							
							<ul>
								<li><a href="/components/goagen/" title="">goagen</a></li>
								<li><a href="/components/runtime/" title="">runtime</a></li>
								<li><a href="/components/swagger/" title="">swagger</a></li>
							</ul>
						</li>
						<li class="dropdown">
							<a href="/middleware/" title="middleware">Middleware</a>
							
							<ul>
								<li><a href="/middleware/jwt/" title="">JWT</a></li>
							</ul>
						</li>
						<li class="dropdown">
							<a href="/plugins/" title="plugins">Plugins</a>
							
							<ul>
								<li><a href="/plugins/gorma/" title="">gorma</a></li>
							</ul>
						</li>
						<li><a href="/tutorials/" title="Tutorials">Tutorials</a></li>
						<li><a href="/blog/" title="Blog">Blog</a></li>
						<li><a href="https://github.com/goadesign/goa" title="GitHub">GitHub</a></li>
					</ul>
				</div>
			</div>
		</nav>

	</header>
	
	
	<section id="content" class="container">

	<div class="hero-unit">
		<h1>middleware</h1>
		<p>godoc for middleware</p>
	</div>

	<hr />

	
	<div class="row" id="blog">

		
		<div class="span8"> 
			

<h1 id="middleware:37ab2f15ff048f67959bcac0a6032f32">middleware</h1>

<pre><code>import &quot;github.com/goadesign/middleware&quot;
</code></pre>

<h2 id="constants:37ab2f15ff048f67959bcac0a6032f32">Constants</h2>

<pre><code class="language-go">const ReqIDKey middlewareKey = 1
</code></pre>

<p>ReqIDKey is the context key used by the RequestID middleware to store the request ID value.</p>

<pre><code class="language-go">const RequestIDHeader = &quot;X-Request-Id&quot;
</code></pre>

<p>RequestIDHeader is the name of the header used to transmit the request ID.</p>

<h2 id="func-logrequest:37ab2f15ff048f67959bcac0a6032f32">func LogRequest</h2>

<pre><code class="language-go">func LogRequest() goa.Middleware
</code></pre>

<p>LogRequest creates a request logger middleware.
This middleware is aware of the RequestID middleware and if registered after it leverages the
request ID for logging.</p>

<h2 id="func-logresponse:37ab2f15ff048f67959bcac0a6032f32">func LogResponse</h2>

<pre><code class="language-go">func LogResponse() goa.Middleware
</code></pre>

<p>LogResponse creates a response logger middleware.
Only Logs the raw response data without accumulating any statistics.</p>

<h2 id="func-recover:37ab2f15ff048f67959bcac0a6032f32">func Recover</h2>

<pre><code class="language-go">func Recover() goa.Middleware
</code></pre>

<p>Recover is a middleware that recovers panics and returns an internal error response.</p>

<h2 id="func-requestid:37ab2f15ff048f67959bcac0a6032f32">func RequestID</h2>

<pre><code class="language-go">func RequestID() goa.Middleware
</code></pre>

<p>RequestID is a middleware that injects a request ID into the context of each request.
Retrieve it using ctx.Value(ReqIDKey). If the incoming request has a RequestIDHeader header then
that value is used else a random value is generated.</p>

<h2 id="func-requireheader:37ab2f15ff048f67959bcac0a6032f32">func RequireHeader</h2>

<pre><code class="language-go">func RequireHeader(
    pathPattern *regexp.Regexp,
    requiredHeaderName string,
    requiredHeaderValue *regexp.Regexp,
    failureStatus int) goa.Middleware
</code></pre>

<p>RequireHeader requires a request header to match a value pattern. If the
header is missing or does not match then the failureStatus is the response
(e.g. http.StatusUnauthorized). If pathPattern is nil then any path is
included. If requiredHeaderValue is nil then any value is accepted so long as
the header is non-empty.</p>

<h2 id="func-timeout:37ab2f15ff048f67959bcac0a6032f32">func Timeout</h2>

<pre><code class="language-go">func Timeout(timeout time.Duration) goa.Middleware
</code></pre>

<p>Timeout sets a global timeout for all controller actions.
The timeout notification is made through the context, it is the responsability of the request
handler to handle it. For example:</p>

<pre><code>func (ctrl *Controller) DoLongRunningAction(ctx *DoLongRunningActionContext) error {
    action := NewLongRunning()      // setup long running action
    c := make(chan error, 1)        // create return channel
    go func() { c &lt;- action.Run() } // Launch long running action goroutine
    select {
    case &lt;- ctx.Done():             // timeout triggered
        action.Cancel()         // cancel long running action
        &lt;-c                     // wait for Run to return.
        return ctx.Err()        // retrieve cancel reason
    case err := &lt;-c:        // action finished on time
        return err          // forward its return value
    }
}
</code></pre>

<p>Package golang.org/x/net/context/ctxhttp contains an implementation of an HTTP client which is
context-aware:</p>

<pre><code>func (ctrl *Controller) HttpAction(ctx *HttpActionContext) error {
    req, err := http.NewRequest(&quot;GET&quot;, &quot;&lt;a href=&quot;http://iamaslowservice.com&quot;&gt;http://iamaslowservice.com&lt;/a&gt;&quot;, nil)
    // ...
    resp, err := ctxhttp.Do(ctx, nil, req) // returns if timeout triggers
    // ...
}
</code></pre>

<p>Controller actions can check if a timeout is set by calling the context Deadline method.</p>

<hr />

<p>Generated by <a href="http://godoc.org/github.com/davecheney/godoc2md">godoc2md</a></p>


		</div>

		
	
		<div class="sidebar span4">

			
			<div class="widget">
				<input id="search" type="search" class="animated" placeholder="Search" />
				 <ul id="results">
    			        </ul>
			</div>

			
			<div class="widget">
				<h4>All Categories</h4>
				<ul class="icons-ul list-style">
					
						<li><a href="/categories/dsl-engine/">dsl-engine</a></li>
					
						<li><a href="/categories/generation/">generation</a></li>
					
						<li><a href="/categories/godoc/">godoc</a></li>
					
						<li><a href="/categories/middleware/">middleware</a></li>
					
						<li><a href="/categories/runtime/">runtime</a></li>
					
						<li><a href="/categories/swagger/">swagger</a></li>
					

				</ul>
			</div>

			
			<div class="widget">
				<h4>All Tags</h4>
				<ul class="tags">
					
						<li><a href="/tags/apidsl/">apidsl</a></li>
					
						<li><a href="/tags/app/">app</a></li>
					
						<li><a href="/tags/auth/">auth</a></li>
					
						<li><a href="/tags/binc/">binc</a></li>
					
						<li><a href="/tags/cbor/">cbor</a></li>
					
						<li><a href="/tags/cellar-cli/">cellar-cli</a></li>
					
						<li><a href="/tags/client/">client</a></li>
					
						<li><a href="/tags/codegen/">codegen</a></li>
					
						<li><a href="/tags/cors/">cors</a></li>
					
						<li><a href="/tags/design/">design</a></li>
					
						<li><a href="/tags/dsl/">dsl</a></li>
					
						<li><a href="/tags/dslengine/">dslengine</a></li>
					
						<li><a href="/tags/example/">example</a></li>
					
						<li><a href="/tags/gen_app/">gen_app</a></li>
					
						<li><a href="/tags/gen_client/">gen_client</a></li>
					
						<li><a href="/tags/gen_gen/">gen_gen</a></li>
					
						<li><a href="/tags/gen_js/">gen_js</a></li>
					
						<li><a href="/tags/gen_main/">gen_main</a></li>
					
						<li><a href="/tags/gen_schema/">gen_schema</a></li>
					
						<li><a href="/tags/gen_swagger/">gen_swagger</a></li>
					
						<li><a href="/tags/genmodels/">genmodels</a></li>
					
						<li><a href="/tags/goa/">goa</a></li>
					
						<li><a href="/tags/goagen/">goagen</a></li>
					
						<li><a href="/tags/godoc/">godoc</a></li>
					
						<li><a href="/tags/gogoprotobuf/">gogoprotobuf</a></li>
					
						<li><a href="/tags/gorma/">gorma</a></li>
					
						<li><a href="/tags/gzip/">gzip</a></li>
					
						<li><a href="/tags/json/">json</a></li>
					
						<li><a href="/tags/jwt/">jwt</a></li>
					
						<li><a href="/tags/meta/">meta</a></li>
					
						<li><a href="/tags/middleware/">middleware</a></li>
					
						<li><a href="/tags/msgpack/">msgpack</a></li>
					
						<li><a href="/tags/swagger/">swagger</a></li>
					
						<li><a href="/tags/test/">test</a></li>
					
						<li><a href="/tags/utils/">utils</a></li>
					
				</ul>
			</div>

		</div>
		<script type="text/javascript" src="/js/lunr.min.js"></script>

    <script type="text/javascript">
    var lunrIndex,
        $results,
        pagesIndex;

    
    function initLunr() {
        
        $.getJSON("/js/pindex.json")
            .done(function(index) {
                pagesIndex = index;
                console.log("index:", pagesIndex);

                
                
                lunrIndex = lunr(function() {
                    this.field("title", {
                        boost: 10
                    });
                    this.field("tags", {
                        boost: 5
                    });
                    this.field("content");

                    
                    this.ref("href");
                });

                
                pagesIndex.forEach(function(page) {
                    lunrIndex.add(page);
                });
            })
            .fail(function(jqxhr, textStatus, error) {
                var err = textStatus + ", " + error;
                console.error("Error getting Hugo index flie:", err);
            });
    }

    
    function initUI() {
        $results = $("#results");
        $("#search").keyup(function() {
            $results.empty();

            
            var query = $(this).val();
            if (query.length < 2) {
                return;
            }

            var results = search(query);

            renderResults(results);
        });
    }

    

    function search(query) {
        
        
        
        
        
        return lunrIndex.search(query).map(function(result) {
                return pagesIndex.filter(function(page) {
                    return page.href === result.ref;
                })[0];
            });
    }

    

    function renderResults(results) {
        if (!results.length) {
            return;
        }

        
        results.slice(0, 10).forEach(function(result) {
            var $result = $("<li>");
            $result.append($("<a>", {
                href: result.href,
                text: "» " + result.title
            }));
            $results.append($result);
        });
    }

    
    initLunr();

    $(document).ready(function() {
        initUI();
    });
    </script>
	

	</div>
	</section>
		

	<footer id="footer">
		<div class="container">
			<div class="row">
				<div class="span4">
					<a class="brand" href="/">
						goa
					</a>
					<p>
						Elegant code generation<br />for your API or microservice. <br />
						Design First
						
					</p>
				</div>
				<div class="span4 social-networks">
					<h3>Find us elsewhere</h3>
					<p>
						<a class="social-network twitter" href="https://twitter.com/goadesign"></a>
					</p>
				</div>
				<div class="span4 newsletter">
					<h3>Developer List</h3>
					<a href="https://groups.google.com/forum/#!forum/goadesign">Join the Google Group</a>
				</div> 
			</div> 		
		</div> 
	</footer>

	<footer id="copyright">
		<div class="container">
			<div class="row">
				<div class="span8">
					&copy; 2015—2016 by <a>Raphael Simon and the goa contributors</a>
				</div>
			</div> 		
		</div> 
	</footer>

	

	<script type="text/javascript" src="/js/bootstrap.min.js"></script>
	<script type="text/javascript" src="/js/jquery.isotope.min.js"></script>
	<script type="text/javascript" src="/js/jquery.touchSwipe.min.js"></script>
	<script type="text/javascript" src="/js/jquery.hotkeys.min.js" charset='utf-8'></script>
	<script type="text/javascript" src="/js/functions.min.js"></script>
	
</body>
</html>		

