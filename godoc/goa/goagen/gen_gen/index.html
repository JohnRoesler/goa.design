<!DOCTYPE html>



<html class="not-ie" lang="en"> 
<head>

	
	<meta charset="utf-8">
	<title>goa :: Design-first API Generation</title>
	<meta name="description" content="Goa is a code generation framework built in Go that provides the developer with a clear and concise path to generate idiomatic API and Microservice architectures by using a design-first methodology.">

	<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">

	
	<link href="/css/style.css" rel="stylesheet" type="text/css" />
	<link href="/css/font-awesome/font-awesome.min.css" rel="stylesheet" />
	
	
	
	<link href='http://fonts.googleapis.com/css?family=Open+Sans:300,400,600,700,800' rel='stylesheet' type='text/css' />

	
	
	<script src="https://ajax.googleapis.com/ajax/libs/jquery/1.10.2/jquery.min.js"></script>
	<script>window.jQuery || document.write('<script src="/js/jquery-1.10.2.min.js"><\/script>')</script>
	
	
	

</head>

<body>

		
	<header id="header">
		
		<nav class="navbar">
			<div class="navbar-inner">
				<div class="container">
					
					<a class="brand" href="/">
						goa
					</a>
					<ul class="nav">
						<li><a href="/" title="Home">Home</a></li>
						<li><a href="/guide/" title="Getting Started">Getting Started</a></li>

						<li class="dropdown">
							<a href="/components/" title="components">Components</a>
							
							<ul>
								<li><a href="/components/goagen/" title="">goagen</a></li>
								<li><a href="/components/runtime/" title="">runtime</a></li>
								<li><a href="/components/swagger/" title="">swagger</a></li>
							</ul>
						</li>
						<li class="dropdown">
							<a href="/middleware/" title="middleware">Middleware</a>
							
							<ul>
								<li><a href="/middleware/jwt/" title="">JWT</a></li>
							</ul>
						</li>
						<li class="dropdown">
							<a href="/plugins/" title="plugins">Plugins</a>
							
							<ul>
								<li><a href="/plugins/gorma/" title="">gorma</a></li>
							</ul>
						</li>
						<li><a href="/tutorials/" title="Tutorials">Tutorials</a></li>
						<li><a href="/blog/" title="Blog">Blog</a></li>
						<li><a href="https://github.com/goadesign/goa" title="GitHub">GitHub</a></li>
					</ul>
				</div>
			</div>
		</nav>

	</header>
	
	
	<section id="content" class="container">

	<div class="hero-unit">
		<h1>goa/goagen/gen_gen</h1>
		<p>godoc for goa/goagen/gen_gen</p>
	</div>

	<hr />

	
	<div class="row" id="blog">

		
		<div class="span8"> 
			

<h1 id="gengen:9a504bf7bd8a773c41a665bab47f73e1">gengen</h1>

<pre><code>import &quot;github.com/goadesign/goa/goagen/gen_gen&quot;
</code></pre>

<p>Package gengen provides goagen with the ability to run user provided generators (<em>plugins</em>).</p>

<h3 id="how-to-write-a-goagen-plugin:9a504bf7bd8a773c41a665bab47f73e1">How to Write a goagen Plugin</h3>

<p>The only requirement is that the package exposes a global Generate function with the following
signature:</p>

<pre><code>func Generate(api *design.APIDefinition) ([]string, error)
</code></pre>

<p>where api is the API definition computed from the design DSL. On success Generate should return
the path to the generated files. On error the error message gets displayed to the user (and
goagen exist with status 1).</p>

<p>The Generate method should take advantage of the APIDefinition IterateXXX methods to iterate
through the API resources, media types and types to guarantee that the order doesn&rsquo;t change
between two invokation of the function (thereby generating different output even if the design
hasn&rsquo;t changed).</p>

<p>They may also take advantage of Metadata. The goa design language allows defining Metadata on a
number of definitions: API, Resource, Action, Response and Attribute (which means Type and
MediaType as well since these definitions are attributes). A metadata field consists of a
key/value pair where both are simple strings. The generator can use these key/value pairs to
produce different results, see example below. Metadata has no effect on the buit-in generators.
The Output directory is available through the codegen.OutputDir global variable.</p>

<p>Package genresnames is an example of a goagen plugin. It creates a file &ldquo;names.txt&rdquo; containing
the names of the API resources sorted in alphabetical order. If a resource has a
metadata pair with the key &ldquo;genresnames/name&rdquo; then the plugin uses the metadata value instead.</p>

<p>Invoke the plugin with:</p>

<pre><code>goagen gen -d &lt;Go package path to design package&gt; --pkg-path=&lt;Go package path to genresnames&gt;
</code></pre>

<p>Source code:</p>

<pre><code>package genresnames

import (
    &quot;io/ioutil&quot;
    &quot;os&quot;
    &quot;path/filepath&quot;
    &quot;strings&quot;

    &quot;gopkg.in/alecthomas/kingpin.v2&quot;

    &quot;github.com/goadesign/goa/design&quot;
    &quot;github.com/goadesign/goa/goagen/codegen&quot;
)

// Generate is the function called by goagen to generate the names file.
func Generate(api *design.APIDefinition) ([]string, error) {
    // Make sure to parse the common flags so that codegen.OutputDir gets properly
    // initialized.
    app := kingpin.New(&quot;Resource names&quot;, &quot;Resource name generator&quot;)
    codegen.RegisterFlags(app)
    if _, err := app.Parse(os.Args[1:]); err != nil {
        panic(err)
    }

    // Now iterate through the resources to gather their names
    names := make([]string, len(api.Resources))
    i := 0
    api.IterateResources(func(res *design.ResourceDefinition) error {
        if n, ok := res.Metadata[&quot;genresnames/name&quot;]; ok {
            names[i] = n
        } else {
            names[i] = res.Name
        }
        i++
        return nil
    })
    content := strings.Join(names, &quot;\n&quot;)

    // Write the output file and return its name
    outputFile := filepath.Join(codegen.OutputDir, &quot;names.txt&quot;)
    ioutil.WriteFile(outputFile, []byte(content), 0644)
    return []string{outputFile}, nil
}
</code></pre>

<h2 id="variables:9a504bf7bd8a773c41a665bab47f73e1">Variables</h2>

<pre><code class="language-go">var (
    // GenPkgPath contains the path to the third party generator Go package.
    GenPkgPath string

    // GenPkgName contains the name of the third party generator Go package.
    GenPkgName string
)
</code></pre>

<h2 id="type-command:9a504bf7bd8a773c41a665bab47f73e1">type Command</h2>

<pre><code class="language-go">type Command struct {
    *codegen.BaseCommand
}
</code></pre>

<p>Command is the goa generic generator command line data structure.
It implements meta.Command.</p>

<h3 id="func-newcommand:9a504bf7bd8a773c41a665bab47f73e1">func NewCommand</h3>

<pre><code class="language-go">func NewCommand() *Command
</code></pre>

<p>NewCommand instantiates a new command.</p>

<h3 id="func-command-registerflags:9a504bf7bd8a773c41a665bab47f73e1">func (*Command) RegisterFlags</h3>

<pre><code class="language-go">func (c *Command) RegisterFlags(r codegen.FlagRegistry)
</code></pre>

<p>RegisterFlags registers the command line flags with the given registry.</p>

<h3 id="func-command-run:9a504bf7bd8a773c41a665bab47f73e1">func (*Command) Run</h3>

<pre><code class="language-go">func (c *Command) Run() ([]string, error)
</code></pre>

<p>Run simply calls the meta generator.</p>

<hr />

<p>Generated by <a href="http://godoc.org/github.com/davecheney/godoc2md">godoc2md</a></p>


		</div>

		
	
		<div class="sidebar span4">

			
			<div class="widget">
				<input id="search" type="search" class="animated" placeholder="Search" />
				 <ul id="results">
    			        </ul>
			</div>

			
			<div class="widget">
				<h4>All Categories</h4>
				<ul class="icons-ul list-style">
					
						<li><a href="/categories/dsl-engine/">dsl-engine</a></li>
					
						<li><a href="/categories/generation/">generation</a></li>
					
						<li><a href="/categories/godoc/">godoc</a></li>
					
						<li><a href="/categories/middleware/">middleware</a></li>
					
						<li><a href="/categories/runtime/">runtime</a></li>
					
						<li><a href="/categories/swagger/">swagger</a></li>
					

				</ul>
			</div>

			
			<div class="widget">
				<h4>All Tags</h4>
				<ul class="tags">
					
						<li><a href="/tags/apidsl/">apidsl</a></li>
					
						<li><a href="/tags/app/">app</a></li>
					
						<li><a href="/tags/auth/">auth</a></li>
					
						<li><a href="/tags/binc/">binc</a></li>
					
						<li><a href="/tags/cbor/">cbor</a></li>
					
						<li><a href="/tags/cellar-cli/">cellar-cli</a></li>
					
						<li><a href="/tags/client/">client</a></li>
					
						<li><a href="/tags/codegen/">codegen</a></li>
					
						<li><a href="/tags/cors/">cors</a></li>
					
						<li><a href="/tags/design/">design</a></li>
					
						<li><a href="/tags/dsl/">dsl</a></li>
					
						<li><a href="/tags/dslengine/">dslengine</a></li>
					
						<li><a href="/tags/example/">example</a></li>
					
						<li><a href="/tags/gen_app/">gen_app</a></li>
					
						<li><a href="/tags/gen_client/">gen_client</a></li>
					
						<li><a href="/tags/gen_gen/">gen_gen</a></li>
					
						<li><a href="/tags/gen_js/">gen_js</a></li>
					
						<li><a href="/tags/gen_main/">gen_main</a></li>
					
						<li><a href="/tags/gen_schema/">gen_schema</a></li>
					
						<li><a href="/tags/gen_swagger/">gen_swagger</a></li>
					
						<li><a href="/tags/genmodels/">genmodels</a></li>
					
						<li><a href="/tags/goa/">goa</a></li>
					
						<li><a href="/tags/goagen/">goagen</a></li>
					
						<li><a href="/tags/godoc/">godoc</a></li>
					
						<li><a href="/tags/gogoprotobuf/">gogoprotobuf</a></li>
					
						<li><a href="/tags/gorma/">gorma</a></li>
					
						<li><a href="/tags/gzip/">gzip</a></li>
					
						<li><a href="/tags/json/">json</a></li>
					
						<li><a href="/tags/jwt/">jwt</a></li>
					
						<li><a href="/tags/meta/">meta</a></li>
					
						<li><a href="/tags/middleware/">middleware</a></li>
					
						<li><a href="/tags/msgpack/">msgpack</a></li>
					
						<li><a href="/tags/swagger/">swagger</a></li>
					
						<li><a href="/tags/test/">test</a></li>
					
						<li><a href="/tags/utils/">utils</a></li>
					
				</ul>
			</div>

		</div>
		<script type="text/javascript" src="/js/lunr.min.js"></script>

    <script type="text/javascript">
    var lunrIndex,
        $results,
        pagesIndex;

    
    function initLunr() {
        
        $.getJSON("/js/pindex.json")
            .done(function(index) {
                pagesIndex = index;
                console.log("index:", pagesIndex);

                
                
                lunrIndex = lunr(function() {
                    this.field("title", {
                        boost: 10
                    });
                    this.field("tags", {
                        boost: 5
                    });
                    this.field("content");

                    
                    this.ref("href");
                });

                
                pagesIndex.forEach(function(page) {
                    lunrIndex.add(page);
                });
            })
            .fail(function(jqxhr, textStatus, error) {
                var err = textStatus + ", " + error;
                console.error("Error getting Hugo index flie:", err);
            });
    }

    
    function initUI() {
        $results = $("#results");
        $("#search").keyup(function() {
            $results.empty();

            
            var query = $(this).val();
            if (query.length < 2) {
                return;
            }

            var results = search(query);

            renderResults(results);
        });
    }

    

    function search(query) {
        
        
        
        
        
        return lunrIndex.search(query).map(function(result) {
                return pagesIndex.filter(function(page) {
                    return page.href === result.ref;
                })[0];
            });
    }

    

    function renderResults(results) {
        if (!results.length) {
            return;
        }

        
        results.slice(0, 10).forEach(function(result) {
            var $result = $("<li>");
            $result.append($("<a>", {
                href: result.href,
                text: "» " + result.title
            }));
            $results.append($result);
        });
    }

    
    initLunr();

    $(document).ready(function() {
        initUI();
    });
    </script>
	

	</div>
	</section>
		

	<footer id="footer">
		<div class="container">
			<div class="row">
				<div class="span4">
					<a class="brand" href="/">
						goa
					</a>
					<p>
						Elegant code generation<br />for your API or microservice. <br />
						Design First
						
					</p>
				</div>
				<div class="span4 social-networks">
					<h3>Find us elsewhere</h3>
					<p>
						<a class="social-network twitter" href="https://twitter.com/goadesign"></a>
					</p>
				</div>
				<div class="span4 newsletter">
					<h3>Developer List</h3>
					<a href="https://groups.google.com/forum/#!forum/goadesign">Join the Google Group</a>
				</div> 
			</div> 		
		</div> 
	</footer>

	<footer id="copyright">
		<div class="container">
			<div class="row">
				<div class="span8">
					&copy; 2015—2016 by <a>Raphael Simon and the goa contributors</a>
				</div>
			</div> 		
		</div> 
	</footer>

	

	<script type="text/javascript" src="/js/bootstrap.min.js"></script>
	<script type="text/javascript" src="/js/jquery.isotope.min.js"></script>
	<script type="text/javascript" src="/js/jquery.touchSwipe.min.js"></script>
	<script type="text/javascript" src="/js/jquery.hotkeys.min.js" charset='utf-8'></script>
	<script type="text/javascript" src="/js/functions.min.js"></script>
	
</body>
</html>		

